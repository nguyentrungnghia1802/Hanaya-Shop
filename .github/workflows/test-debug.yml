name: 🧪 Test Workflow Debug

on:
  workflow_dispatch:
  push:
    branches: [develop]
    paths: ['.github/workflows/test-debug.yml']

jobs:
  debug:
    name: 🔍 Debug Branch Detection
    runs-on: ubuntu-latest
    
    steps:
      - name: Debug Info
        run: |
          echo "🔍 Branch Detection Debug"
          echo "github.ref: ${{ github.ref }}"
          echo "github.ref_name: ${{ github.ref_name }}"
          echo "github.event_name: ${{ github.event_name }}"
          echo "github.head_ref: ${{ github.head_ref }}"
          echo "github.base_ref: ${{ github.base_ref }}"
          
      - name: Test Conditions
        run: |
          echo "Testing Docker build condition..."
          if [[ "${{ github.ref }}" == "refs/heads/develop" ]]; then
            echo "✅ Docker should run (refs/heads/develop match)"
          else
            echo "❌ Docker condition not met"
          fi
          
          if [[ "${{ github.ref_name }}" == "develop" ]]; then
            echo "✅ Docker should run (ref_name match)"
          else
            echo "❌ ref_name condition not met"
          fi

  test-pint:
    name: 🎨 Test Laravel Pint
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.2'
          tools: composer:v2
          
      - name: Install dependencies
        run: composer install --no-interaction --prefer-dist
        
      - name: Test Pint without format
        run: |
          echo "Testing Laravel Pint..."
          ./vendor/bin/pint --test || echo "Pint check completed"